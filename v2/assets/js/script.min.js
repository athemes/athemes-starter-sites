"use strict";!function(r){function l(t,e,i){var s,a,o,n;i++,e.length>i&&e[i]?(s=e[i].log||"",a=Math.round(100/e.length*i),t.find(".atss-import-progress-label").html(s),t.find(".atss-import-progress-sublabel").html(a+"%"),t.find(".atss-import-progress-indicator").attr("style","--atss-indicator: "+a+"%;"),s=window.atss_localize.nonce,a=t.find('input[name="demo_id"]').val(),o=t.find('input[name="builder_type"]:checked').val(),n=t.find('input[name="content_type"]:checked').val(),delete(s=r.extend({nonce:s,demo_id:a,builder_type:o,content_type:n},e[i])).log,delete s.priority,r.post(window.atss_localize.ajax_url,s,function(s){s.success?(s.status&&"newAJAX"===s.status&&i--,setTimeout(function(){l(t,e,i)},500)):(s.data?(t.find(".atss-import-step-error").addClass("atss-active").siblings().removeClass("atss-active"),t.find(".atss-import-error-log").html(s.data)):(t.find(".atss-import-step-error").addClass("atss-active").siblings().removeClass("atss-active"),t.find(".atss-import-error-log").html(window.atss_localize.i18n.import_failed)),p.removeClass("atss-import-in-progress"))}).fail(function(){t.find(".atss-import-step-error").addClass("atss-active").siblings().removeClass("atss-active"),t.find(".atss-import-error-log").html(window.atss_localize.i18n.import_failed),p.removeClass("atss-import-in-progress")})):(t.find(".atss-import-progress-label").html(window.atss_localize.i18n.import_finished),t.find(".atss-import-progress-sublabel").html("100%"),t.find(".atss-import-progress-indicator").attr("style","--atss-indicator: 100%;"),a="minutes",m<300&&((o=new Date).setTime(1e3*m),a=0<o.getMinutes()?o.getMinutes()+"."+String(o.getSeconds()).padStart(2,"0")+" minutes":o.getSeconds()+" seconds"),n=window.atss_localize.i18n.tweet_text.replace("{0}",a),t.find(".atss-import-finish-tweet-text").html(n),t.find(".atss-import-finish-tweet-button").attr("href","https://twitter.com/intent/tweet?text="+n),setTimeout(function(){t.find(".atss-import-step").removeClass("atss-active"),t.find(".atss-import-step-finish").addClass("atss-active"),p.removeClass("atss-import-in-progress")},250),c.addClass("atss-demo-item-imported").siblings().removeClass("atss-demo-item-imported"),clearInterval(d),m=1),f=!0}var d,c,p=r("body"),m=1,f=!1;r(document).ready(function(){var a,i,o,s=r(".atss-notice"),n=(s.length&&s.find(".notice-dismiss").on("click",function(){s.parent().hide(),r.post(window.atss_localize.ajax_url,{action:"atss_dismissed_handler",nonce:window.atss_localize.nonce})}),r(".atss"));n.length&&(a=n.find(".atss-demo-item"),n.find(".atss-import"),i=n.find(".atss-preview"),n.on("click",".atss-demo-preview-button",function(s){s.preventDefault();var t,s=r(this),e=s.closest(".atss-demo-item"),s={preview:s.attr("href"),info:e.find(".atss-demo-info").html(),actions:e.find(".atss-demo-actions").html()};p.hasClass("atss-preview-show")?(i.find(".atss-preview-iframe").attr("src",s.preview),i.find(".atss-preview-header-info").html(s.info),i.find(".atss-preview-header-actions").html(s.actions)):(t=wp.template("atss-preview"),i.html(t(s))),p.addClass("atss-preview-show"),o=e.index(),n.trigger("atss-nav-click",[o])}),n.on("click",".atss-preview-header-arrow-prev",function(s){s.preventDefault(),r(this).hasClass("atss-disabled")||(o--,a.eq(o).find(".atss-demo-preview-button").trigger("click"))}),n.on("click",".atss-preview-header-arrow-next",function(s){s.preventDefault(),r(this).hasClass("atss-disabled")||(o++,a.eq(o).find(".atss-demo-preview-button").trigger("click"))}),n.on("click",".atss-preview-cancel-button",function(s){s.preventDefault(),p.removeClass("atss-preview-show"),i.empty()}),n.on("atss-nav-click",function(s,t){var e=n.find(".atss-preview-header-arrow-prev"),i=n.find(".atss-preview-header-arrow-next");(0===t?(e.addClass("atss-disabled"),i):(a.length-1===t?i.addClass("atss-disabled"):i.removeClass("atss-disabled"),e)).removeClass("atss-disabled")}),n.on("click",".atss-import-open-button",function(s){s.preventDefault();var s=r(this).data("demo-id"),t=window.atss_localize.demos[s],e=wp.template("atss-import");t&&t.builders.length&&(c=r(this).closest(".atss-demo-item"),t.args={},t.args.demoId=s,t.args.quick=r(this).data("quick")||t.builders.length<2||!1,t.args.builder=r(this).data("builder")||t.builders[0],t.args.imported=window.atss_localize.imported||f,n.find(".atss-import").html(e(t)),p.addClass("atss-import-show"))}),n.on("click",".atss-import-close-button",function(s){s.preventDefault(),p.removeClass("atss-import-show")}),n.on("click",".atss-import-toggle-button",function(s){s.preventDefault(),r(this).parent().toggleClass("atss-active")}),n.on("click",".atss-import-prev-button",function(s){s.preventDefault();s=r(this).closest(".atss-import-step");s.removeClass("atss-active"),s.prev().addClass("atss-active")}),n.on("click",".atss-import-next-button",function(s){s.preventDefault();s=r(this).closest(".atss-import-step");s.removeClass("atss-active"),s.next().addClass("atss-active")}),n.on("click",".atss-import-start-button",function(s){s.preventDefault();s=n.find(".atss-import-form");if(r(this).data("subscribe")){var t=s.find(".atss-import-subscribe-field-email"),e=t.val();s.find(".atss-import-subscribe-field-count-me").is(":checked");if(!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e))return void t.addClass("atss-error").attr("placeholder",window.atss_localize.i18n.invalid_email).val("")}var e=r(this).closest(".atss-import-step"),i=(e.removeClass("atss-active"),e.next().addClass("atss-active"),[]);s.find("input[data-action]").each(function(s){(r(this).is(":checked")||r(this).is('[type="hidden"]'))&&i.push(r(this).data())}),i=i.sort(function(s,t){return s.priority-t.priority}),d=setInterval(function(){m++},1e3),p.addClass("atss-import-in-progress"),l(s,i,-1)}))})}(jQuery);